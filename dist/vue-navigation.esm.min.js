/**
* vue-navigation v1.0.0
* https://github.com/zack24q/vue-navigation
* Released under the MIT License.
*/
function genKey(){return"xxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function getKey(t,e){return(t.name||t.path)+"?"+t.query[e]}function matches(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:!!isRegExp(t)&&t.test(e)}var routes=[];window.sessionStorage.VUE_NAVIGATION&&(routes=JSON.parse(window.sessionStorage.VUE_NAVIGATION));var Routes=routes,Navigator=function(t,e,n,o){e&&e.registerModule(n,{state:{routes:Routes},mutations:{"navigation/FORWARD":function(t,e){e.to,e.from;var n=e.name;t.routes.push(n)},"navigation/BACK":function(t,e){e.to,e.from;var n=e.count;t.routes.splice(t.routes.length-n,n)},"navigation/REFRESH":function(t,e){e.to,e.from},"navigation/RESET":function(t){t.routes.splice(0,t.routes.length)}}});var r=function(o,r,a){var i={route:r},s={route:a},u=e?e.state[n].routes:Routes;s.name=u[u.length-1]||null,i.name=o,e?e.commit("navigation/FORWARD",{to:i,from:s,name:o}):u.push(o),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(u),t.$emit("forward",i,s)},a=function(o,r,a){var i={route:r},s={route:a},u=e?e.state[n].routes:Routes;s.name=u[u.length-1],i.name=u[u.length-1-o],e?e.commit("navigation/BACK",{to:i,from:s,count:o}):u.splice(Routes.length-o,o),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(u),t.$emit("back",i,s)},i=function(o,r){var a={route:o},i={route:r},s=e?e.state[n].routes:Routes;a.name=i.name=s[s.length-1],e&&e.commit("navigation/REFRESH",{to:a,from:i}),t.$emit("refresh",a,i)};return{record:function(t,e){var n=getKey(t,o),s=Routes.lastIndexOf(n);-1===s?r(n,t,e):s===Routes.length-1?i(t,e):a(Routes.length-1-s,t,e)},reset:function(){e?e.commit("navigation/RESET"):Routes.splice(0,Routes.length),window.sessionStorage.VUE_NAVIGATION=JSON.stringify([]),t.$emit("reset")}}},NavComponent=function(t){return{name:"navigation",abstract:!0,props:{},data:function(){return{routes:Routes}},computed:{},watch:{routes:function(t){for(var e in this.cache)if(!matches(t,e)){var n=this.cache[e];n&&n.componentInstance.$destroy(),delete this.cache[e]}}},created:function(){this.cache={}},destroyed:function(){for(var t in this.cache){var e=this.cache[t];e&&e.componentInstance.$destroy()}},render:function(){var e=this.$slots.default?this.$slots.default[0]:null;if(e){var n=getKey(this.$route,t);e.key+=n,this.cache[n]?e.componentInstance=this.cache[n].componentInstance:this.cache[n]=e,e.data.keepAlive=!0}return e}}},_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},index={install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.router,o=e.store,r=e.moduleName,a=void 0===r?"navigation":r,i=e.keyName,s=void 0===i?"VNK":i;if(n){var u=new t,c=Navigator(u,o,a,s);n.beforeEach(function(t,e,n){if(t.query[s])n();else{var o=_extends({},t.query);o[s]=genKey(),n({path:t.path,query:o,replace:!e.query[s]})}}),n.afterEach(function(t,e){c.record(t,e)}),t.component("navigation",NavComponent(s)),t.navigation=t.prototype.$navigation={on:function(t,e){u.$on(t,e)},once:function(t,e){u.$once(t,e)},off:function(t,e){u.$off(t,e)},getRoutes:function(){return Routes.slice()},cleanRoutes:function(){return c.reset()}}}else console.error("vue-navigation need options: router")}};export default index;